<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人博客</title>
    <!-- 引入 LeanCloud SDK -->
    <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.15.0/dist/av-min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; line-height: 1.6; background: #f4f4f9; color: #333; }
        header { background: #333; color: #fff; padding: 10px 20px; text-align: center; font-size: 1.5em; }
        .content { padding: 20px; max-width: 800px; margin: 20px auto; background: #fff; border-radius: 5px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
        input, textarea { width: 100%; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        button { padding: 10px 20px; background: #555; color: #fff; border: none; border-radius: 5px; cursor: pointer; }
        .blog-post { margin-top: 20px; padding: 10px; border-radius: 5px; background: #f9f9f9; box-shadow: 0 0 5px rgba(0, 0, 0, 0.1); }
    </style>
</head>
<body>

<header>
    <h1>我的博客</h1>
</header>

<div class="content">
    <h2>发布文章</h2>
    <input type="text" id="title" placeholder="请输入文章标题">
    <textarea id="content" placeholder="请输入文章内容"></textarea>
    <button onclick="saveBlog()">保存</button>
</div>

<div class="content">
    <h2>博客文章</h2>
    <div id="blog-list"></div>
</div>

<script>
    // 1. 初始化 LeanCloud
    AV.init({
        appId: "rFvLX8TnTWI94pZ8SK3S20G-gGzoHsz",
        appKey: "cMiXx7mKhvzbu0NBkC6hTfS",
        serverURL: "https://rfvlx8tn.lc-cn-n1-shared.com"
    });

    // 2. 保存博客文章到 LeanCloud
    function saveBlog() {
        const title = document.getElementById("title").value;
        const content = document.getElementById("content").value;

        if (title && content) {
            const Blog = AV.Object.extend("Blogs");
            const blog = new Blog();
            blog.set("title", title);
            blog.set("content", content);
            blog.set("timestamp", new Date().toLocaleString());

            blog.save().then(() => {
                alert("博客已保存！");
                document.getElementById("title").value = "";
                document.getElementById("content").value = "";
                loadBlogs();  // 重新加载博客
            }).catch(error => {
                console.error("保存失败：", error);
                alert("保存失败，请检查控制台！");
            });
        } else {
            alert("请输入标题和内容！");
        }
    }

    // 3. 读取博客文章
    function loadBlogs() {
        const query = new AV.Query("Blogs");
        query.descending("createdAt");

        query.find().then(blogs => {
            const blogList = document.getElementById("blog-list");
            blogList.innerHTML = "";

            blogs.forEach(blog => {
                const blogData = blog.toJSON();
                const blogPost = document.createElement("div");
                blogPost.classList.add("blog-post");
                blogPost.innerHTML = `<h3>${blogData.title}</h3><p>${blogData.content}</p ><p style="font-size: 0.9em; color: #555;">发布时间: ${blogData.timestamp}</p >`;
                blogList.appendChild(blogPost);
            });
        }).catch(error => {
            console.error("加载失败：", error);
            alert("加载失败，请检查控制台！");
        });
    }

    // 4. 页面加载时获取文章
    document.addEventListener("DOMContentLoaded", loadBlogs);
</script>

</body>
</html>
